<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Integrated Gamma Copula Definition • igcop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Integrated Gamma Copula Definition">
<meta property="og:description" content="igcop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">igcop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/definition.html">Integrated Gamma Copula Definition</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vincenzocoia/igcop">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="definition_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Integrated Gamma Copula Definition</h1>
            
      
      
      <div class="hidden name"><code>definition.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">igcop</span><span class="op">)</span></pre></div>
<p>The generic copula class (DJ and interpolated DJ) is characterized by a <em>generating function</em> <span class="math inline">\(\psi:[0, \infty) \rightarrow (0, 1]\)</span>, which needs to be a concave distribution function or convex survival function.</p>
<p>This manuscript provides results for a generic copula generated by some <span class="math inline">\(\psi\)</span>, in addition to the IG and IGL classes. Note that <span class="math inline">\(\psi\)</span> need not have an inverse – the results still hold for the left-inverse, <span class="math inline">\(\psi^{\leftarrow}\)</span>.</p>
<div id="preliminary-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#preliminary-functions" class="anchor"></a>Preliminary Functions</h1>
<div id="incomplete-gamma-function" class="section level2">
<h2 class="hasAnchor">
<a href="#incomplete-gamma-function" class="anchor"></a>Incomplete Gamma Function</h2>
<p>The (Upper) Incomplete Gamma function is defined as <span class="math display">\[\Gamma^{*}(\alpha, x) = \int_x^{\infty} t ^ {\alpha - 1} e ^ {-t} dt\]</span> for <span class="math inline">\(\alpha &gt; 0\)</span> and <span class="math inline">\(x \ge 0\)</span>, and the Gamma function is defined as <span class="math inline">\(\Gamma(\alpha) = \Gamma^{*}(\alpha, 0)\)</span>.</p>
<p>In R, the Gamma function is accessible through the function <code><a href="https://rdrr.io/r/base/Special.html">gamma()</a></code>, and the igcop package makes the Incomplete Gamma function accessible through the <code><a href="../reference/igamma.html">igamma()</a></code> function.</p>
<p>To make the <code><a href="../reference/igamma.html">igamma()</a></code> function, the igcop package uses the Gamma distribution function <code><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma()</a></code> with <code>scale</code> or <code>rate</code> equal to 1, and <code>shape</code> equal to <span class="math inline">\(\alpha\)</span> as an indirect way of accessing the Incomplete Gamma function. Denoting this Gamma cdf as <span class="math inline">\(F_{\alpha}\)</span>, the relationship is <span class="math display">\[F_{\alpha}(x) = 1 - \frac{\Gamma^{*}(\alpha, x)}{\Gamma(\alpha)}.\]</span></p>
</div>
<div id="generating-function" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-function" class="anchor"></a>Generating Function</h2>
<p>The IG and IGL copula families result from a parametric generating function <span class="math inline">\(\Psi_k\)</span> for <span class="math inline">\(k &gt; 1\)</span>, defined below.</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="25%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Formula</th>
<th align="center">igcop function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\Psi_k(y)\)</span></td>
<td align="center"><span class="math display">\[
\begin{cases}
  y \frac{\Gamma(k) - \Gamma^{*}(k, y ^ {-1})}{\Gamma(k - 1)} +
    \frac{\Gamma^{*}(k - 1,y ^ {-1})}{\Gamma(k - 1)}, &amp; y &gt; 0;\\
  0, &amp; y = 0
\end{cases}
\]</span></td>
<td align="center"><code><a href="../reference/igl_gen.html">igl_gen()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\Psi_k'(y)\)</span></td>
<td align="center"><span class="math display">\[
\frac{\Gamma(k) - \Gamma^{*}(k, 1  / y)}
     {\Gamma(k - 1)}
\]</span></td>
<td align="center"><code><a href="../reference/igl_gen.html">igl_gen_D()</a></code></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\Psi_k''(y)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{y ^ {-k - 1} \exp(-1 / y)}
      {\Gamma(k - 1)}
\]</span></td>
<td align="center"><code><a href="../reference/igl_gen.html">igl_gen_DD()</a></code></td>
</tr>
</tbody>
</table>
<p>The “kappa” version of the generating function is also important.</p>
<p>General definition.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\kappa_{\psi}(y)\)</span></td>
<td align="center"><span class="math inline">\(\psi(y) - y \psi'(y)\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\kappa_{\psi}'(y)\)</span></td>
<td align="center"><span class="math inline">\(-y \psi''(y)\)</span></td>
</tr>
</tbody>
</table>
<p>Taking our specific generating function in place of <span class="math inline">\(\psi\)</span>:</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="25%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Formula</th>
<th align="center">igcop function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\kappa_k(y) := \kappa_{\Psi_k}(y)\)</span></td>
<td align="center"><span class="math display">\[
\frac{\Gamma^{*}(k - 1, 1 / y)}
     {\Gamma(k - 1)} = 1 - \text{pgamma}(1 / y, k - 1)
\]</span></td>
<td align="center"><code><a href="../reference/igl_kappa.html">igl_kappa()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\kappa_k'(y)\)</span></td>
<td align="center"><span class="math display">\[
\frac{\exp(-1/y)}{y ^ k \Gamma(k - 1)} =
\frac{\text{dgamma}(1 / y, k - 1)}{y ^ 2}
\]</span></td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="interpolating-function" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolating-function" class="anchor"></a>Interpolating Function</h2>
<p>The copula arising from the generating function <span class="math inline">\(\psi\)</span> gives rise to a parametric copula family governed by a parameter <span class="math inline">\(\theta &gt; 0\)</span>, where <span class="math inline">\(\theta = 0\)</span> is the independence copula, and <span class="math inline">\(\theta \rightarrow \infty\)</span> results in the original copula. As such, this copula family <em>interpolates</em> a DJ copula, giving rise to an even wider class of copulas.</p>
<p>The interpolated class of copulas relies on an <em>interpolating function</em> function <span class="math inline">\(H_\psi(\cdot; \theta): [1,\infty) \rightarrow (0, 1]\)</span>, defined below.</p>
<p>Generic definition of the interpolating function:</p>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(H_{\psi}(y; \eta)\)</span></td>
<td align="center"><span class="math display">\[
\begin{cases}
  \frac{1}{y}\psi\left(\frac{1}{\eta \log y}\right), &amp; y &gt; 1;\\
  1, &amp; y = 1
\end{cases}
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\text{D}_1 H_{\psi}(t; \eta)\)</span></td>
<td align="center"><span class="math display">\[
  -\frac{1}{t ^ 2}
  \left[
    \psi\left(\frac{1}{\eta \log t}\right) + 
    \frac{1}{\eta (\log t) ^ 2} \psi'\left(\frac{1}{\eta \log t}\right)
  \right]
\]</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\text{D}_2 H_k(t; \eta)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{1}{t \eta ^ 2 \log t}
\psi'\left(\frac{1}{\eta \log t}\right)
\]</span></td>
</tr>
</tbody>
</table>
<p>Definition of the interpolating function using the IGL generating function <span class="math inline">\(\Psi_k\)</span> (taking <span class="math inline">\(H_k := H_{\Psi_k}\)</span>):</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="25%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Formula</th>
<th align="center">igcop function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(H_k(t; \eta)\)</span></td>
<td align="center"><span class="math display">\[
\begin{cases}
  \frac{1}{t}\Psi_k\left(\frac{1}{\eta \log t}\right), &amp; t &gt; 1;\\
  1, &amp; t = 1
\end{cases}
\]</span></td>
<td align="center"><code><a href="../reference/interp_gen.html">interp_gen()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\text{D}_1 H_k(t; \eta)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{
  (\log t + 1) (\Gamma(k) - \Gamma^{*}(k, \eta \log t)) +
  \eta (\log t) ^ 2 \Gamma^{*}(k - 1, \eta \log t)
}{
  \eta (t \log t) ^ 2 \Gamma(k - 1)
}
\]</span></td>
<td align="center"><code><a href="../reference/interp_gen.html">interp_gen_D1()</a></code></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\text{D}_2 H_k(t; \eta)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{1}{t \eta ^ 2 \log t}
\frac{\Gamma(k) - \Gamma^{*}(k,\eta \log t)}{\Gamma(k)}
\]</span></td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<p>For the IG copula, <span class="math inline">\(H_k := H_{\Psi_k}\)</span> (function <code><a href="../reference/interp_gen.html">interp_gen()</a></code> in the igcop package). Note that <span class="math inline">\(H_k(\cdot; \theta)\)</span> is strictly decreasing for all <span class="math inline">\(\theta &gt; 0\)</span> and <span class="math inline">\(k &gt; 1\)</span>, so <span class="math inline">\(H_k^{-1}(\cdot; \theta)\)</span> is the unique inverse function of <span class="math inline">\(H_k(\cdot; \theta)\)</span>.</p>
<p>OLD PLOTS (OF SOMETHING LIKE H_KAPPA)</p>
<p><img src="definition_files/figure-html/plots-1.png" width="480"><img src="definition_files/figure-html/plots-2.png" width="480"><img src="definition_files/figure-html/plots-3.png" width="480"></p>
</div>
</div>
<div id="copula-formulas" class="section level1">
<h1 class="hasAnchor">
<a href="#copula-formulas" class="anchor"></a>Copula Formulas</h1>
<div id="dj-copula-class" class="section level2">
<h2 class="hasAnchor">
<a href="#dj-copula-class" class="anchor"></a>DJ Copula Class</h2>
<p>The Durante-Jaworski copula class:</p>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th align="center">Quantity</th>
<th align="center">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(C(u, v; \psi)\)</span></td>
<td align="center"><span class="math display">\[
u + v - 1 + (1 - u) \psi\left((1 - u) ^ {-1} \psi^{\leftarrow}(1 - v)\right)
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{2 | 1}(v | u; \psi)\)</span></td>
<td align="center"><span class="math display">\[
1 - \kappa_{\psi}\left((1 - u) ^ {-1} \psi ^ {\leftarrow}(1 - v) \right)
\]</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{1 | 2}(u | v; \psi)\)</span></td>
<td align="center"><span class="math display">\[
1 - \frac{\psi'\left((1 - u) ^ {-1} \psi ^ {\leftarrow}(1 - v)\right)}
         {\psi'\left(\psi ^ {\leftarrow}(1 - v)\right)}
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(c(u, v; \psi)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{
  \psi ^ {\leftarrow}(1 - v) 
  \psi''\left((1 - u)^{-1} \psi^{\leftarrow}(1 - v)\right)
}{
  (1 - u) ^ 2 \psi'\left(\psi^{\leftarrow}(1 - v)\right)
}
\]</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{2 | 1}^{-1}(\tau | u; \psi)\)</span></td>
<td align="center"><span class="math display">\[
1 - \psi((1 - u) \kappa_{\psi}^{\leftarrow}(1 - \tau))
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{1 | 2}^{-1}(\tau | v; \psi)\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Note that <span class="citation">Coia (2017)</span> in E.1.2 writes these distributional quantities as if the family was defined as reflections.</p>
</div>
<div id="dj-copula-class-with-psi_k-igl-copula-class" class="section level2">
<h2 class="hasAnchor">
<a href="#dj-copula-class-with-psi_k-igl-copula-class" class="anchor"></a>DJ Copula Class with <span class="math inline">\(\Psi_k\)</span>: IGL Copula Class</h2>
<p>The parameter space is <span class="math inline">\(k &gt; 1\)</span>. <strong>Note</strong>: Values of <span class="math inline">\(k &lt; 2\)</span> lead to unstable computations – especially with <span class="math inline">\(k\)</span> close to 1.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="23%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="center">Quantity</th>
<th align="center">Formula</th>
<th align="center">distplyr function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(C(u, v; k)\)</span></td>
<td align="center"><span class="math display">\[
u + v - 1 + (1 - u) \Psi_k\left((1 - u) ^ {-1} \Psi_k^{-1}(1 - v)\right)
\]</span></td>
<td align="center"><code><a href="../reference/qcondiglcop.html">piglcop()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{2 | 1}(v | u; k)\)</span></td>
<td align="center"><span class="math display">\[
1- \frac{\Gamma^{*}\left(k - 1, (1 - u) / 
           \Psi_k ^ {-1}(1 - v)\right)}
        {\Gamma\left(k-1\right)}
\]</span></td>
<td align="center">
<code><a href="../reference/qcondiglcop.html">pcondiglcop()</a></code>, <code><a href="../reference/qcondiglcop.html">pcondiglcop21()</a></code>
</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{1 | 2}(u | v; k)\)</span></td>
<td align="center"><span class="math display">\[
1 - \frac{\Gamma(k) - \Gamma^{*}\left(k, (1 - u) / 
            \Psi_k ^ {-1}(1 - v)\right)}
         {\Gamma(k) - \Gamma^{*}\left(k, 1 / 
            \Psi_k ^ {-1}(1 - v)\right)}
\]</span></td>
<td align="center"><code><a href="../reference/qcondiglcop.html">pcondiglcop12()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(c(u, v; k)\)</span></td>
<td align="center"><span class="math display">\[\frac{
  (1 - u)^{k-1}
  \left[\Psi_k^{-1}(1 - v)\right] ^ {-k}
  \exp\left\{-(1 - u) / \Psi_k^{-1}(1 - v)\right\} 
}{
  \Gamma(k) - \Gamma^{*}\left(k, 1 / \Psi_k^{-1}(1 - v)\right)
}\]</span></td>
<td align="center"><code><a href="../reference/qcondiglcop.html">diglcop()</a></code></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{2 | 1}^{-1}(\tau | u; k)\)</span></td>
<td align="center"><span class="math display">\[
1 - \Psi_k\left(\frac{1 - u}{\text{qgamma}(\tau, k - 1)}\right)
\]</span></td>
<td align="center">
<code><a href="../reference/qcondiglcop.html">qcondiglcop()</a></code>, <code><a href="../reference/qcondiglcop.html">qcondiglcop21()</a></code>
</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{1 | 2}^{-1}(\tau | v; k)\)</span></td>
<td align="center"></td>
<td align="center"><code><a href="../reference/qcondiglcop.html">qcondiglcop12()</a></code></td>
</tr>
</tbody>
</table>
</div>
<div id="interpolated-dj-copula-class" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolated-dj-copula-class" class="anchor"></a>Interpolated DJ Copula Class</h2>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th align="center">Quantity</th>
<th align="center">Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(C(u, v; \theta, \psi)\)</span></td>
<td align="center"><span class="math display">\[
u + v - 1 + (1 - u) H_{\psi}\left(H_{\psi} ^ {\leftarrow}(1 - v; \theta); \theta (1 - u)\right)
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{2 | 1}(v | u; \theta, \psi)\)</span></td>
<td align="center"><span class="math display">\[
1 - H_{\kappa_{\psi}}\left(H_{\psi} ^ {\leftarrow}(1 - v; \theta); \theta (1 - u)\right)
\]</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{1 | 2}(u | v; \theta, \psi)\)</span></td>
<td align="center">
<span class="math display">\[
1 - (1 - u) \frac{
  \psi\left(\frac{1}{\theta (1 - u) \log t}\right) + 
  \frac{1}{\theta (1 - u) (\log t) ^ 2} 
  \psi'\left(\frac{1}{\theta (1 - u) \log t}\right)
} {
  \psi\left(\frac{1}{\theta \log t}\right) +
  \frac{1}{\theta (\log t) ^ 2} 
  \psi'\left(\frac{1}{\theta \log t}\right)
}
\]</span> where <span class="math inline">\(t = H_{\psi} ^ {\leftarrow}(1 - v; \theta)\)</span>
</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(c(u, v; \theta, \psi)\)</span></td>
<td align="center">
<span class="math display">\[
\frac{
  \kappa_{\psi}\left(\frac{1}{\theta (1 - u) \log t}\right) +
  \frac{1}{\theta (1 - u) (\log t) ^ 2}
  \kappa_{\psi}'\left(\frac{1}{\theta (1 - u) \log t}\right)
} {
  \psi\left(\frac{1}{\theta \log t}\right) +
  \frac{1}{\theta (\log t) ^ 2}
  \psi'\left(\frac{1}{\theta \log t}\right)
}
\]</span> where <span class="math inline">\(t = H_{\psi} ^ {\leftarrow}(1 - v; \theta)\)</span>
</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{2 | 1}^{-1}(\tau | u; \theta, \psi)\)</span></td>
<td align="center"><span class="math display">\[
1 - H_{\psi}\left(H_{\kappa_{\psi}}^{\leftarrow}(1 - \tau; \theta (1 - u)); \theta \right)
\]</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{1 | 2}^{-1}(\tau | v; \theta, \psi)\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Note that <span class="citation">Coia (2017)</span> in E.2.2 writes these distributional quantities in terms of the reflection copula.</p>
</div>
<div id="interpolated-dj-copula-class-with-psi_k-ig-copula" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolated-dj-copula-class-with-psi_k-ig-copula" class="anchor"></a>Interpolated DJ Copula Class with <span class="math inline">\(\Psi_k\)</span>: IG copula</h2>
<p>The parameter space is <span class="math inline">\(\theta \ge 0\)</span>, <span class="math inline">\(k &gt; 1\)</span>. <strong>Note</strong>: Values of <span class="math inline">\(k &lt; 2\)</span> lead to unstable computations – especially with <span class="math inline">\(k\)</span> close to 1.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="23%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="center">Quantity</th>
<th align="center">Formula</th>
<th align="center">distplyr function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(C(u, v; \theta, k)\)</span></td>
<td align="center"><span class="math display">\[
u + v - 1 + (1 - u) H_k\left(H_k ^ {-1}(1 - v; \theta); \theta (1 - u)\right)
\]</span></td>
<td align="center"><code><a href="../reference/pcondigcop.html">pigcop()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{2 | 1}(v | u; \theta, k)\)</span></td>
<td align="center"><span class="math display">\[
1 - \frac{
  \Gamma^{*}\left(k - 1, \theta (1 - u) 
  \log\left(H_k^{-1}(1 - v; \theta)\right)\right)
}{
  H_k^{-1}(1 - v; \theta) \Gamma(k - 1)
}
\]</span></td>
<td align="center">
<code><a href="../reference/pcondigcop.html">pcondigcop()</a></code>, <code><a href="../reference/pcondigcop.html">pcondigcop21()</a></code>
</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{1 | 2}(u | v; \theta, k)\)</span></td>
<td align="center"><span class="math display">\[
1 - (1 - u) \frac{
  \text{D}_1 H_k\left(H_k^{-1}(1 - v; \theta); 
  \theta(1 - u)\right)
}{
  \text{D}_1 H_k\left(H_k^{-1}(1 - v; \theta); 
  \theta\right)
} 
\]</span></td>
<td align="center"><code><a href="../reference/pcondigcop.html">pcondigcop12()</a></code></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(c(u, v; \theta, k)\)</span></td>
<td align="center"><span class="math display">\[
-\frac{
  \theta ^ {k - 1} (1 - u) ^ {k-1} (\log t_v) ^ {k - 2} t_v ^ {-\theta (1 - u)} + 
  \Gamma^{*}(k - 1, \theta (1 - u) \log  t_v)
}{
  \Gamma(k - 1) t_v ^ 2 \text{D}_1 H_k(t_v; \theta)
}
\]</span></td>
<td align="center"><code><a href="../reference/pcondigcop.html">digcop()</a></code></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(C_{2 | 1}^{-1}(\tau | u; \theta, k)\)</span></td>
<td align="center"></td>
<td align="center">
<code><a href="../reference/pcondigcop.html">qcondigcop()</a></code>, <code><a href="../reference/pcondigcop.html">qcondigcop21()</a></code>
</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(C_{1 | 2}^{-1}(\tau | v; \theta, k)\)</span></td>
<td align="center"></td>
<td align="center"><code>qcondigcop12()</code></td>
</tr>
</tbody>
</table>
<p>(Note that <span class="citation">Coia (2017)</span> mistakenly writes <span class="math inline">\(H_{\psi}\)</span> instead of <span class="math inline">\(H_k\)</span> in the formula for <span class="math inline">\(C_{\text{IG}, 1 | 2}\)</span>.)</p>
<p>The copula family is named “Integrated Gamma” because <span class="math inline">\(\Psi_k'(1 / \cdot)\)</span> is proportional to the Gamma distribution cdf with scale parameter 1 and shape parameter <span class="math inline">\(k\)</span>.</p>
<p>These two families are related, in that <span class="math display">\[\lim_{\theta \rightarrow \infty} C_{IG}(u, v; \theta, k) = C_{IGL}(u, v; k)\]</span> for all <span class="math inline">\(k\)</span>. Further, taking <span class="math inline">\(\theta = 0\)</span> results in the independence copula, so that the IG copula family is an “interpolation” between the independence copula and each IGL copula.</p>
</div>
</div>
<div id="translating-formulas-to-code" class="section level1">
<h1 class="hasAnchor">
<a href="#translating-formulas-to-code" class="anchor"></a>Translating formulas to code</h1>
<div id="generating-function-psi_k" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-function-psi_k" class="anchor"></a>Generating Function <span class="math inline">\(\Psi_k\)</span>
</h2>
<p>Noting that <span class="math inline">\(\Gamma(k - 1) = \Gamma(k) / (k - 1)\)</span>,</p>
<p><span class="math display">\[
\Psi_k(t) = 
y (k - 1) \left(1 - 
    \frac{\Gamma^{*}(k, y ^ {-1})}{\Gamma(k)}
    \right) +
    \left(\frac{\Gamma^{*}(k - 1,y ^ {-1})}{\Gamma(k - 1)}\right)
\]</span></p>
<p>The two major parentheses can be calculated from the Gamma cdf: the first set being <code><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma(1 / y, shape = k)</a></code>, and the second set being <code><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma(1 / y, shape = k - 1, lower.tail = FALSE)</a></code>. Here is the definition of <code>igl_gen</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">igl_gen</span></pre></div>
<pre><code>## function (t, k) 
## {
##     tinv &lt;- 1/t
##     (k - 1) * t * stats::pgamma(tinv, k) + stats::pgamma(tinv, 
##         k - 1, lower.tail = FALSE)
## }
## &lt;bytecode: 0x7f8cb47903f0&gt;
## &lt;environment: namespace:igcop&gt;</code></pre>
<p>The derivative is proportional to the Gamma density. Using the same Gamma function identity:</p>
<p><span class="math display">\[
\Psi_k'(y) = 
(k - 1) \left(1 - \frac{\Gamma^{*}(k, y ^ {-1})}{\Gamma(k)}\right)
\]</span></p>
</div>
</div>
<div id="computing-inverses" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-inverses" class="anchor"></a>Computing inverses</h1>
<p>To compute by solving <span class="math inline">\(\varphi_k(x; \eta) = p\)</span> for <span class="math inline">\(x\)</span>, the Newton-Raphson algorithm is used to solve <span class="math inline">\(g(x) = 0\)</span> for <span class="math inline">\(x\)</span>, where <span class="math display">\[
g\left(x\right)=xp-\bar{F}_{k-1}\left(\eta\log x\right),
\]</span> with derivative <span class="math display">\[
g'\left(x\right)=p+\frac{\eta}{x}f_{k-1}\left(\eta\log x\right).
\]</span> A starting value is used by noting that <span class="math inline">\(\varphi_k\)</span> is the product of two invertible survival functions, and is therefore smaller than those two survival functions. The smaller of the two <em>roots</em> of these survival functions is therefore an upper bound for the root of <span class="math inline">\(\varphi_k\)</span>. The starting point is taken to be immediately to the left of this upper bound.</p>
<div id="computing-interp_gen_inv" class="section level3">
<h3 class="hasAnchor">
<a href="#computing-interp_gen_inv" class="anchor"></a>Computing <code>interp_gen_inv</code>
</h3>
<p>To compute <span class="math inline">\(H_k^{\leftarrow}\left(p,\theta\right)\)</span> for <span class="math inline">\(p\in\left(0,1\right)\)</span> and some <span class="math inline">\(\theta&gt;0\)</span>, Newton-Raphson can be used to solve <span class="math inline">\(h\left(x\right)=0\)</span> for <span class="math inline">\(x\)</span>, where <span class="math display">\[
h\left(x\right)=xp-\Psi_k\left(\frac{1}{\theta\log x}\right).
\]</span> This function has derivative <span class="math display">\[
h'\left(x\right)=p+\frac{1}{\theta x\left(\log x\right)^2}\Psi_k'\left(\frac{1}{\theta\log x}\right).
\]</span></p>
<p>To get a good starting value for the algorithm, note that the function <span class="math inline">\(H_k\)</span> is a product of two survival functions, just like <span class="math inline">\(\varphi_k\)</span> is. And like inverting <span class="math inline">\(\varphi_k\)</span>, the inverse <span class="math inline">\(H_k^{\leftarrow}\left(p;\theta\right)\)</span> for some <span class="math inline">\(\theta&gt;0\)</span> has an upper bound that’s the minimum of the roots of the individual survival functions: <span class="math display">\[
\min\left\{ \frac{1}{p},\exp\left(\frac{1}{\theta\Psi_k^{\leftarrow}\left(p\right)}\right)\right\} ,
\]</span> where <span class="math inline">\(\Psi_k\)</span> is defined in Equation~(@ref(eq:cnstr-Psi)). Computing the inverse <span class="math inline">\(\Psi_k^{\leftarrow}\)</span> should not be problematic in terms of accuracy of the final result, since this computation is only used to determine a starting value.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-coia2017">
<p>Coia, Vincenzo. 2017. “Forecasting of Nonlinear Extreme Quantiles using Copula Models.” PhD Dissertation, The University of British Columbia.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://vincenzocoia.com">Vincenzo Coia</a>, Harry Joe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
